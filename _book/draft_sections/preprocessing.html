<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Patrick Kelley">

<title>9&nbsp; Data Exploration I: Outliers and Extra Zeros – Quantitative Analysis of (Messy) Field Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../draft_sections/intro_modeling.html" rel="next">
<link href="../draft_sections/data_exploration.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../draft_sections/data_exploration.html">Part II: Chaos to Columns</a></li><li class="breadcrumb-item"><a href="../draft_sections/preprocessing.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Exploration I: Outliers and Extra Zeros</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/analytical_jackalope4.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../images/analytical_jackalope4.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Quantitative Analysis of (Messy) Field Data</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Course Information</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/01_welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Course Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/housekeeping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">housekeeping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/02_course_roadmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Course Roadmap</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/03_syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Syllabus</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/statistical_aphorisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistical Aphorisms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/naming_conventions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Naming conventions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Chaos to Columns</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/data_exploration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data exploration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/preprocessing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Exploration I: Outliers and Extra Zeros</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Columns to Curves</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/intro_modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/glms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">glms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../draft_sections/glm_poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Generalized Linear Models for Count Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part IV: Curves to Meaning</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">9.1</span> Overview</a></li>
  <li><a href="#the-data-exploration-toolkit" id="toc-the-data-exploration-toolkit" class="nav-link" data-scroll-target="#the-data-exploration-toolkit"><span class="header-section-number">9.2</span> The Data Exploration Toolkit</a></li>
  <li><a href="#types-of-outliers" id="toc-types-of-outliers" class="nav-link" data-scroll-target="#types-of-outliers"><span class="header-section-number">9.3</span> Types of Outliers</a>
  <ul class="collapse">
  <li><a href="#univariate-outliers" id="toc-univariate-outliers" class="nav-link" data-scroll-target="#univariate-outliers"><span class="header-section-number">9.3.1</span> Univariate Outliers</a></li>
  <li><a href="#multivariate-outliers" id="toc-multivariate-outliers" class="nav-link" data-scroll-target="#multivariate-outliers"><span class="header-section-number">9.3.2</span> Multivariate Outliers</a></li>
  <li><a href="#influential-observations" id="toc-influential-observations" class="nav-link" data-scroll-target="#influential-observations"><span class="header-section-number">9.3.3</span> Influential Observations</a></li>
  <li><a href="#measurement-and-processing-errors" id="toc-measurement-and-processing-errors" class="nav-link" data-scroll-target="#measurement-and-processing-errors"><span class="header-section-number">9.3.4</span> Measurement and Processing Errors</a></li>
  <li><a href="#natural-oddities-black-swans" id="toc-natural-oddities-black-swans" class="nav-link" data-scroll-target="#natural-oddities-black-swans"><span class="header-section-number">9.3.5</span> Natural Oddities (“Black Swans”)</a></li>
  </ul></li>
  <li><a href="#identifying-univariate-outliers" id="toc-identifying-univariate-outliers" class="nav-link" data-scroll-target="#identifying-univariate-outliers"><span class="header-section-number">9.4</span> Identifying Univariate Outliers</a>
  <ul class="collapse">
  <li><a href="#statistical-identification" id="toc-statistical-identification" class="nav-link" data-scroll-target="#statistical-identification"><span class="header-section-number">9.4.1</span> Statistical Identification</a></li>
  <li><a href="#expert-judgment" id="toc-expert-judgment" class="nav-link" data-scroll-target="#expert-judgment"><span class="header-section-number">9.4.2</span> Expert Judgment</a></li>
  </ul></li>
  <li><a href="#graphical-approaches-to-univariate-outliers" id="toc-graphical-approaches-to-univariate-outliers" class="nav-link" data-scroll-target="#graphical-approaches-to-univariate-outliers"><span class="header-section-number">9.5</span> Graphical Approaches to Univariate Outliers</a>
  <ul class="collapse">
  <li><a href="#cleveland-plots-dot-charts" id="toc-cleveland-plots-dot-charts" class="nav-link" data-scroll-target="#cleveland-plots-dot-charts"><span class="header-section-number">9.5.1</span> Cleveland Plots (Dot Charts)</a></li>
  <li><a href="#tukey-box-plots" id="toc-tukey-box-plots" class="nav-link" data-scroll-target="#tukey-box-plots"><span class="header-section-number">9.5.2</span> Tukey Box Plots</a></li>
  <li><a href="#conditional-box-plots" id="toc-conditional-box-plots" class="nav-link" data-scroll-target="#conditional-box-plots"><span class="header-section-number">9.5.3</span> Conditional Box Plots</a></li>
  </ul></li>
  <li><a href="#caveats-with-univariate-outliers" id="toc-caveats-with-univariate-outliers" class="nav-link" data-scroll-target="#caveats-with-univariate-outliers"><span class="header-section-number">9.6</span> Caveats with Univariate Outliers</a></li>
  <li><a href="#multivariate-outliers-1" id="toc-multivariate-outliers-1" class="nav-link" data-scroll-target="#multivariate-outliers-1"><span class="header-section-number">9.7</span> Multivariate Outliers</a></li>
  <li><a href="#mahalanobis-distance" id="toc-mahalanobis-distance" class="nav-link" data-scroll-target="#mahalanobis-distance"><span class="header-section-number">9.8</span> Mahalanobis Distance</a>
  <ul class="collapse">
  <li><a href="#extensions-minimum-covariance-determinant-mcd" id="toc-extensions-minimum-covariance-determinant-mcd" class="nav-link" data-scroll-target="#extensions-minimum-covariance-determinant-mcd"><span class="header-section-number">9.8.1</span> Extensions: Minimum Covariance Determinant (MCD)</a></li>
  </ul></li>
  <li><a href="#what-to-do-if-you-identify-an-outlier" id="toc-what-to-do-if-you-identify-an-outlier" class="nav-link" data-scroll-target="#what-to-do-if-you-identify-an-outlier"><span class="header-section-number">9.9</span> What to Do If You Identify an Outlier</a>
  <ul class="collapse">
  <li><a href="#remove-the-outlier-with-justification" id="toc-remove-the-outlier-with-justification" class="nav-link" data-scroll-target="#remove-the-outlier-with-justification"><span class="header-section-number">9.9.1</span> 1. Remove the Outlier (With Justification)</a></li>
  <li><a href="#conduct-concurrent-analyses" id="toc-conduct-concurrent-analyses" class="nav-link" data-scroll-target="#conduct-concurrent-analyses"><span class="header-section-number">9.9.2</span> 2. Conduct Concurrent Analyses</a></li>
  <li><a href="#do-nothing-often-the-best-choice" id="toc-do-nothing-often-the-best-choice" class="nav-link" data-scroll-target="#do-nothing-often-the-best-choice"><span class="header-section-number">9.9.3</span> 3. Do Nothing (Often the Best Choice)</a></li>
  <li><a href="#do-not-transform-the-data" id="toc-do-not-transform-the-data" class="nav-link" data-scroll-target="#do-not-transform-the-data"><span class="header-section-number">9.9.4</span> 4. Do <em>Not</em> Transform the Data</a></li>
  </ul></li>
  <li><a href="#ethical-and-biological-considerations" id="toc-ethical-and-biological-considerations" class="nav-link" data-scroll-target="#ethical-and-biological-considerations"><span class="header-section-number">9.10</span> Ethical and Biological Considerations</a></li>
  <li><a href="#extra-zeros-in-the-data" id="toc-extra-zeros-in-the-data" class="nav-link" data-scroll-target="#extra-zeros-in-the-data"><span class="header-section-number">9.11</span> Extra Zeros in the Data</a></li>
  <li><a href="#why-extra-zeros-matter" id="toc-why-extra-zeros-matter" class="nav-link" data-scroll-target="#why-extra-zeros-matter"><span class="header-section-number">9.12</span> Why Extra Zeros Matter</a></li>
  <li><a href="#visual-inspection-for-zero-inflation" id="toc-visual-inspection-for-zero-inflation" class="nav-link" data-scroll-target="#visual-inspection-for-zero-inflation"><span class="header-section-number">9.13</span> Visual Inspection for Zero Inflation</a></li>
  <li><a href="#quantifying-zero-inflation" id="toc-quantifying-zero-inflation" class="nav-link" data-scroll-target="#quantifying-zero-inflation"><span class="header-section-number">9.14</span> Quantifying Zero Inflation</a></li>
  <li><a href="#wrap-up" id="toc-wrap-up" class="nav-link" data-scroll-target="#wrap-up"><span class="header-section-number">9.15</span> Wrap-Up</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../draft_sections/data_exploration.html">Part II: Chaos to Columns</a></li><li class="breadcrumb-item"><a href="../draft_sections/preprocessing.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Exploration I: Outliers and Extra Zeros</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Exploration I: Outliers and Extra Zeros</span></h1>
<p class="subtitle lead">Day 3 — Video 3</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Patrick Kelley </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">9.1</span> Overview</h2>
<p>Welcome back. This marks the beginning of the <strong>data exploration phase</strong> of the course. In this video, we focus on <strong>basic exploratory steps</strong> that should always be done <em>before</em> formal modeling.</p>
<p>The goal here is not to perform inference, but to identify potential problems early—before they complicate or derail the analysis phase. In the next video, we will move on to coping with <strong>heterogeneity in the data</strong>, particularly through variance structures.</p>
<hr>
</section>
<section id="the-data-exploration-toolkit" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="the-data-exploration-toolkit"><span class="header-section-number">9.2</span> The Data Exploration Toolkit</h2>
<p>Across this section of the course, we will work through five core data exploration steps:</p>
<ol type="1">
<li>Identifying outliers (univariate and multivariate)<br>
</li>
<li>Identifying extra zeros in the data<br>
</li>
<li>Assessing multicollinearity<br>
</li>
<li>Thinking carefully about interactions<br>
</li>
<li>Deciding whether to standardize covariates</li>
</ol>
<p>These steps are meant to give you a <strong>practical toolkit</strong> for diagnosing issues early. Skipping them often leads to paralysis during the modeling phase. Many of these are mistakes I have made myself over the years—and learned from the hard way.</p>
<p>In this video, we focus on <strong>Steps 1 and 2: outliers and extra zeros</strong>.</p>
<hr>
</section>
<section id="types-of-outliers" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="types-of-outliers"><span class="header-section-number">9.3</span> Types of Outliers</h2>
<p>Outliers arise for many reasons, and not all outliers are errors. It is useful to think about different types:</p>
<section id="univariate-outliers" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="univariate-outliers"><span class="header-section-number">9.3.1</span> Univariate Outliers</h3>
<p>These occur in <strong>one dimension only</strong>—a single variable. For example, a body size measurement that is larger than expected relative to the rest of the population.</p>
<p>These values may be: - Slightly larger or smaller than expected - Rare but biologically plausible - Statistically extreme, depending on assumptions</p>
<hr>
</section>
<section id="multivariate-outliers" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="multivariate-outliers"><span class="header-section-number">9.3.2</span> Multivariate Outliers</h3>
<p>Multivariate outliers occur when a data point is unusual <strong>in combination across variables</strong>, even if it is not extreme in any single variable.</p>
<p>These are extremely common in real datasets and often more important than univariate outliers.</p>
<hr>
</section>
<section id="influential-observations" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="influential-observations"><span class="header-section-number">9.3.3</span> Influential Observations</h3>
<p>These are data points that exert <strong>disproportionate influence</strong> on a regression model. They are typically identified <em>after</em> modeling (e.g., via Cook’s distance).</p>
<p>This approach is common, but it is not blind to inference and can introduce bias if used carelessly. Decisions about data inclusion should not be driven by p-values.</p>
<hr>
</section>
<section id="measurement-and-processing-errors" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="measurement-and-processing-errors"><span class="header-section-number">9.3.4</span> Measurement and Processing Errors</h3>
<p>Outliers may arise from:</p>
<ul>
<li>Data entry errors</li>
<li>Spreadsheet mistakes</li>
<li>Miscommunication during field measurements</li>
<li>Instrument or observer error</li>
</ul>
<p>This is why rigorous data quality control is essential.</p>
<hr>
</section>
<section id="natural-oddities-black-swans" class="level3" data-number="9.3.5">
<h3 data-number="9.3.5" class="anchored" data-anchor-id="natural-oddities-black-swans"><span class="header-section-number">9.3.5</span> Natural Oddities (“Black Swans”)</h3>
<p>Some outliers are <strong>real and biologically meaningful</strong>. Rare events—such as extreme climatic years or unusual individuals—may have disproportionate ecological importance.</p>
<p>Automatically removing such observations risks losing genuine scientific insight.</p>
<hr>
</section>
</section>
<section id="identifying-univariate-outliers" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="identifying-univariate-outliers"><span class="header-section-number">9.4</span> Identifying Univariate Outliers</h2>
<p>A classic definition (Moore &amp; McCabe):</p>
<blockquote class="blockquote">
<p><em>An outlier is an observation that lies outside the overall pattern of a distribution.</em></p>
</blockquote>
<p>This definition is inherently univariate. There are two broad approaches to identifying outliers:</p>
<section id="statistical-identification" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="statistical-identification"><span class="header-section-number">9.4.1</span> Statistical Identification</h3>
<p>This depends on: - Sample size - Assumptions about the underlying distribution</p>
<p>With small sample sizes, this approach can be fragile and misleading.</p>
<hr>
</section>
<section id="expert-judgment" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="expert-judgment"><span class="header-section-number">9.4.2</span> Expert Judgment</h3>
<p>This relies on domain knowledge, but must be applied cautiously. Appeals to authority are not substitutes for statistical reasoning, though in some cases expert knowledge is indispensable.</p>
<hr>
</section>
</section>
<section id="graphical-approaches-to-univariate-outliers" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="graphical-approaches-to-univariate-outliers"><span class="header-section-number">9.5</span> Graphical Approaches to Univariate Outliers</h2>
<p>Before modeling, graphical inspection provides a useful first approximation.</p>
<section id="cleveland-plots-dot-charts" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1" class="anchored" data-anchor-id="cleveland-plots-dot-charts"><span class="header-section-number">9.5.1</span> Cleveland Plots (Dot Charts)</h3>
<p>Cleveland plots rank observations and display them visually. They make <strong>no distributional assumptions</strong> and are purely exploratory.</p>
<p>They are subjective, but effective for spotting values that warrant further attention.</p>
<hr>
</section>
<section id="tukey-box-plots" class="level3" data-number="9.5.2">
<h3 data-number="9.5.2" class="anchored" data-anchor-id="tukey-box-plots"><span class="header-section-number">9.5.2</span> Tukey Box Plots</h3>
<p>Tukey-style box plots are widely used and based on <strong>quantiles</strong>, not normality.</p>
<p>Key components:</p>
<ul>
<li><p>The box spans the interquartile range (IQR):</p>
<p><span class="math display">\[
\text{IQR} = Q_3 - Q_1
\]</span></p></li>
<li><p>Whiskers extend to <span class="math inline">\(1.5 \times \text{IQR}\)</span></p></li>
<li><p>Points beyond this threshold are flagged as outliers</p></li>
<li><p>Points beyond <span class="math inline">\(3 \times \text{IQR}\)</span> may be flagged as <em>extreme</em> outliers</p></li>
</ul>
<p>These thresholds are <strong>arbitrary</strong> but conventional. They provide a consistent rule of thumb rather than a strict statistical test.</p>
<hr>
</section>
<section id="conditional-box-plots" class="level3" data-number="9.5.3">
<h3 data-number="9.5.3" class="anchored" data-anchor-id="conditional-box-plots"><span class="header-section-number">9.5.3</span> Conditional Box Plots</h3>
<p>Conditional box plots split the data by a grouping factor (e.g., month, treatment, site).</p>
<p>Advantages: - Can scale box width by sample size - Highlight where outliers originate - Useful for diagnosing heterogeneity across groups</p>
<hr>
</section>
</section>
<section id="caveats-with-univariate-outliers" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="caveats-with-univariate-outliers"><span class="header-section-number">9.6</span> Caveats with Univariate Outliers</h2>
<p>Be especially cautious with <strong>small sample sizes</strong>.</p>
<p>For example, data drawn from a Gamma distribution (bounded at zero, right-skewed) may produce values flagged as outliers by Tukey’s rule—even when they are perfectly consistent with the true distribution.</p>
<p>Outliers identified by a rule are not necessarily statistical anomalies.</p>
<hr>
</section>
<section id="multivariate-outliers-1" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="multivariate-outliers-1"><span class="header-section-number">9.7</span> Multivariate Outliers</h2>
<p>Most datasets are multivariate. A data point may appear normal in each variable individually, yet be extreme in multivariate space.</p>
<p>This is where univariate methods fail.</p>
<hr>
</section>
<section id="mahalanobis-distance" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="mahalanobis-distance"><span class="header-section-number">9.8</span> Mahalanobis Distance</h2>
<p>A powerful method for identifying multivariate outliers is <strong>Mahalanobis distance</strong>, which accounts for covariance among variables.</p>
<p>Conceptually, it measures how far a point is from the multivariate centroid:</p>
<p><span class="math display">\[
D^2 = (x - \mu)^T \Sigma^{-1} (x - \mu)
\]</span></p>
<p>In practice, this can be implemented using existing R packages (e.g., <code>psych</code>) and works well for moderate-dimensional datasets.</p>
<hr>
<section id="extensions-minimum-covariance-determinant-mcd" class="level3" data-number="9.8.1">
<h3 data-number="9.8.1" class="anchored" data-anchor-id="extensions-minimum-covariance-determinant-mcd"><span class="header-section-number">9.8.1</span> Extensions: Minimum Covariance Determinant (MCD)</h3>
<p>A newer variant uses a subset (e.g., 75%) of the data to estimate covariance robustly, then flags points outside that structure.</p>
<p>Advantages: - Improves model convergence - Produces stable coefficient estimates</p>
<p>Disadvantages: - Can be overly aggressive in flagging outliers - Requires careful justification</p>
<p>This approach is promising but still evolving.</p>
<hr>
</section>
</section>
<section id="what-to-do-if-you-identify-an-outlier" class="level2" data-number="9.9">
<h2 data-number="9.9" class="anchored" data-anchor-id="what-to-do-if-you-identify-an-outlier"><span class="header-section-number">9.9</span> What to Do If You Identify an Outlier</h2>
<p>There is no single correct response. Options include:</p>
<section id="remove-the-outlier-with-justification" class="level3" data-number="9.9.1">
<h3 data-number="9.9.1" class="anchored" data-anchor-id="remove-the-outlier-with-justification"><span class="header-section-number">9.9.1</span> 1. Remove the Outlier (With Justification)</h3>
<p>Removal must be justified using <strong>multiple lines of evidence</strong>, such as: - Field notes - Known anomalies (e.g., storms, injuries) - Instrument failure</p>
<hr>
</section>
<section id="conduct-concurrent-analyses" class="level3" data-number="9.9.2">
<h3 data-number="9.9.2" class="anchored" data-anchor-id="conduct-concurrent-analyses"><span class="header-section-number">9.9.2</span> 2. Conduct Concurrent Analyses</h3>
<p>Run models: - With the outlier included - With the outlier removed</p>
<p>Report both results transparently. If conclusions are unchanged, the outlier has little influence.</p>
<hr>
</section>
<section id="do-nothing-often-the-best-choice" class="level3" data-number="9.9.3">
<h3 data-number="9.9.3" class="anchored" data-anchor-id="do-nothing-often-the-best-choice"><span class="header-section-number">9.9.3</span> 3. Do Nothing (Often the Best Choice)</h3>
<p>With adequate sample size, individual outliers rarely matter. If one point drastically changes results, the real issue is often insufficient data.</p>
<hr>
</section>
<section id="do-not-transform-the-data" class="level3" data-number="9.9.4">
<h3 data-number="9.9.4" class="anchored" data-anchor-id="do-not-transform-the-data"><span class="header-section-number">9.9.4</span> 4. Do <em>Not</em> Transform the Data</h3>
<p>Data transformation is largely obsolete in modern statistical practice. It is unnecessary for most models and can actively distort inference.</p>
<p>Transformations often fail to achieve their stated goals and introduce new problems.</p>
<hr>
</section>
</section>
<section id="ethical-and-biological-considerations" class="level2" data-number="9.10">
<h2 data-number="9.10" class="anchored" data-anchor-id="ethical-and-biological-considerations"><span class="header-section-number">9.10</span> Ethical and Biological Considerations</h2>
<p>Do <strong>not</strong> remove outliers that are biologically meaningful:</p>
<ul>
<li>Extreme climate years</li>
<li>Rare but dominant individuals</li>
<li>Unusual but real ecological events</li>
</ul>
<p>These often generate the most interesting hypotheses.</p>
<hr>
</section>
<section id="extra-zeros-in-the-data" class="level2" data-number="9.11">
<h2 data-number="9.11" class="anchored" data-anchor-id="extra-zeros-in-the-data"><span class="header-section-number">9.11</span> Extra Zeros in the Data</h2>
<p>The second focus of this video is identifying <strong>excess zeros</strong>, which can cause serious modeling issues.</p>
<p>We are <em>not</em> trying to force data into normality. Instead, we want to understand whether the data reasonably approximate a distribution we intend to model.</p>
<hr>
</section>
<section id="why-extra-zeros-matter" class="level2" data-number="9.12">
<h2 data-number="9.12" class="anchored" data-anchor-id="why-extra-zeros-matter"><span class="header-section-number">9.12</span> Why Extra Zeros Matter</h2>
<p>Excess zeros can:</p>
<ol type="1">
<li>Prevent model convergence</li>
<li>Produce unstable or misleading coefficient estimates</li>
</ol>
<p>If the likelihood surface is poorly defined, the estimation algorithm may fail or settle on spurious solutions.</p>
<hr>
</section>
<section id="visual-inspection-for-zero-inflation" class="level2" data-number="9.13">
<h2 data-number="9.13" class="anchored" data-anchor-id="visual-inspection-for-zero-inflation"><span class="header-section-number">9.13</span> Visual Inspection for Zero Inflation</h2>
<p>A practical approach:</p>
<ul>
<li>Plot a histogram</li>
<li>Increase the number of bins</li>
<li>Zoom into the lower range (e.g., 0–10)</li>
</ul>
<p>If the frequency at zero is much higher than expected under a Poisson or Gamma distribution, zero inflation may be present.</p>
<hr>
</section>
<section id="quantifying-zero-inflation" class="level2" data-number="9.14">
<h2 data-number="9.14" class="anchored" data-anchor-id="quantifying-zero-inflation"><span class="header-section-number">9.14</span> Quantifying Zero Inflation</h2>
<p>A simple diagnostic:</p>
<ul>
<li>Calculate the proportion of zeros</li>
<li>If more than ~50% of observations are zero, standard GLMs may struggle</li>
</ul>
<p>Importantly, <strong>zeros are not bad data</strong>. They often represent real biological states (e.g., non-breeders, absence).</p>
<p>They simply require the <strong>appropriate model</strong>, which we will cover later.</p>
<hr>
</section>
<section id="wrap-up" class="level2" data-number="9.15">
<h2 data-number="9.15" class="anchored" data-anchor-id="wrap-up"><span class="header-section-number">9.15</span> Wrap-Up</h2>
<p>In this video, we covered:</p>
<ul>
<li>Types of outliers</li>
<li>Graphical and statistical tools for identifying them</li>
<li>Ethical considerations for handling outliers</li>
<li>Identification of excess zeros and why they matter</li>
</ul>
<p>These steps should be completed <strong>before</strong> formal modeling. They prevent bias, reduce frustration, and lead to more defensible inference.</p>
<p>In the next section, we will move on to <strong>heterogeneity and variance structures</strong>.</p>
<hr>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../draft_sections/data_exploration.html" class="pagination-link" aria-label="Data exploration">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data exploration</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../draft_sections/intro_modeling.html" class="pagination-link" aria-label="modeling">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>