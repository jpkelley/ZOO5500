---
title: "Spatial Autocorrelation and Non-Independence in Ecological Data"
format: html
---

# Overview and Learning Goals

-   \[Explain why spatial autocorrelation violates independence assumptions\]
-   \[Describe how ignoring spatial structure biases inference\]
-   \[Preview tools for detecting and accounting for spatial autocorrelation\]

# Why We Care About Spatial Autocorrelation

-   \[Review independence assumption in regression models\]
-   \[Explain how autocorrelation reduces standard errors and inflates significance\]
-   \[Describe consequences for p-values, confidence intervals, and AIC\]

# Historical Motivation

## John Snow and the Broad Street Pump

-   \[Describe cholera outbreak and household clustering\]
-   \[Explain why spatial clustering confounded inference\]
-   \[Relate example to modern ecological datasets\]

# What Is Spatial Autocorrelation?

-   \[Define spatial autocorrelation formally\]
-   \[Explain dependence on both distance and similarity\]
-   \[Distinguish spatial from temporal autocorrelation\]

## Types of Spatial Autocorrelation

-   \[Describe positive autocorrelation (clustering)\]
-   \[Describe negative autocorrelation (repulsion)\]
-   \[Describe spatial randomness\]

# Tobler’s First Law of Geography

-   \[State Tobler’s First Law\]
-   \[Explain why nearby locations tend to be similar\]
-   \[Discuss ecological relevance across spatial scales\]

# Spatial Autocorrelation as Signal

-   \[Explain how autocorrelation can be informative\]
-   \[Describe uses as null models and descriptors of organization\]
-   \[Discuss when autocorrelation is a feature rather than a nuisance\]

# Detecting Spatial Autocorrelation

## Exploratory Visualization

-   \[Describe plotting response or residuals in space\]
-   \[Explain visual indicators of clustering\]

## Residual Autocorrelation

-   \[Explain use of residuals from a non-spatial model\]
-   \[Describe limitations of acf() for spatial data\]

# Measuring Spatial Autocorrelation

## Variograms

-   \[Define variograms conceptually\]
-   \[Explain relationship between distance and variance\]
-   \[Describe interpretation of flat vs. structured variograms\]

### How Variograms Work

-   \[Describe spatial lags\]
-   \[Explain pairwise comparisons within lag bins\]
-   \[Describe calculation of semivariance\]

## Moran’s I

-   \[Define Moran’s I statistic\]
-   \[Explain interpretation of I \< 0, I = 0, I \> 0\]
-   \[Describe randomization tests for significance\]

# Workflow: Diagnosing Spatial Autocorrelation

-   \[Fit a non-spatial model\]
-   \[Assess residual spatial structure\]
-   \[Use variograms and/or Moran’s I\]
-   \[Decide whether spatial correction is required\]

# Strategies for Dealing with Spatial Non-Independence

-   \[Introduce three broad approaches\]
-   \[Discuss trade-offs among approaches\]

## Hierarchical Random Effects

-   \[Describe spatial grouping as random effects\]
-   \[Explain when block, plot, or site effects suffice\]
-   \[Discuss limits of categorical spatial grouping\]

## Spatial Coordinates as Predictors

-   \[Describe latitude, longitude, and interaction terms\]
-   \[Explain modeling latent spatial gradients\]
-   \[Discuss when this approach fails\]

## Distance-Based Correlation Structures

-   \[Describe explicit spatial correlation structures\]
-   \[Explain concept of neighborhood effects\]
-   \[Introduce range, nugget, and sill parameters\]

# Implementing Spatial Correlation Structures

-   \[Describe fitting correlation structures via variograms\]
-   \[Explain spherical, exponential, and Gaussian models\]
-   \[Discuss computational cost and convergence issues\]

# Refitting Models with Spatial Structure

-   \[Describe GAMMs with spatial correlation\]
-   \[Explain need for coordinate projection\]
-   \[Discuss practical limitations for large datasets\]

# Spatial Autocovariates

## Concept and Motivation

-   \[Define spatial autocovariates\]
-   \[Describe endogenous processes causing clustering\]

## Constructing Spatial Autocovariates

-   \[Describe distance thresholds\]
-   \[Explain distance weighting schemes\]
-   \[Explain inclusion as fixed effects\]

## Strengths and Pitfalls

-   \[Discuss interpretability issues\]
-   \[Explain risks of circularity\]
-   \[Summarize debates in the literature\]

# Choosing an Approach

-   \[Provide guidance on matching method to study design\]
-   \[Discuss data size, resolution, and biological mechanism\]
-   \[Emphasize parsimony and transparency\]

# Take-Home Messages

-   \[Reinforce that spatial autocorrelation is common\]
-   \[Emphasize diagnosing before correcting\]
-   \[Highlight integration with GLMMs, GAMs, and AIC\]
